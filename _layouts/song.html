---
layout: default
---

{% assign current_song = page %}

<!-- DEBUG BLOCK (keep as-is) -->
<div style="background:#111; color:#0ff; padding:1rem; margin:1rem 0; font-family:monospace; white-space:pre-wrap;">
  <!-- your existing debug content -->
</div>

<main>

  <!-- SONG TITLE + SUBTITLE -->
  <section class="song-header">
    <h2 class="section-header">{{ current_song.title }}</h2>
    {% if current_song.subtitle %}
      <p class="song-subtitle">{{ current_song.subtitle }}</p>
    {% endif %}
  </section>

  <!-- LOOKUP META FROM music.yml -->
  {% assign url = current_song.url %}
  {% assign meta = site.data.music.songs | where: "url", url | first %}

  <!-- EMBED -->
  <div id="playlist-player" class="playlist-player">
    <iframe
      id="playlist-iframe"
      width="100%"
      height="360"
      src="https://www.youtube.com/embed/{{ meta.youtube_id }}"
      frameborder="0"
      allowfullscreen>
    </iframe>
  </div>

  <!-- CAROUSEL (RIGHT UNDER EMBED) -->
  {% assign related = site.data.music.songs | where: "primary_playlist", meta.primary_playlist %}
  {% assign related_public = related | where: "videostatus", "Public" %}
  {% assign sorted_by_sequence = related_public | sort: "sequence" %}
  {% assign first_item = sorted_by_sequence | first %}

  {% if first_item.sequence %}
    {% assign playlist_sorted = sorted_by_sequence %}
  {% else %}
    {% assign playlist_sorted = related_public | sort: "title" %}
  {% endif %}

  {% if meta.primary_playlist %}
    {% include carousel.html 
         songs=playlist_sorted 
         current=current_song 
         public_only=true 
         mode="song" 
    %}
  {% endif %}

  <!-- ABOUT + LYRICS -->
  <div id="song-details" class="song-details">
    <h2 id="song-title">{{ current_song.title }}</h2>
    <p id="song-description">{{ current_song.about }}</p>
    <div id="song-lyrics">
      {{ current_song.lyrics | markdownify }}
    </div>
  </div>

</main>
