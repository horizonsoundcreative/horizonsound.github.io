<!-- DEBUG START -->
<div style="background:#222; color:#0f0; padding:1rem; margin:1rem 0; font-family:monospace;">

  <h3>DEBUG: song_playlist.html</h3>

  <p><strong>current_song:</strong> {{ include.current_song | inspect }}</p>
  <p><strong>current_song.url:</strong> {{ include.current_song.url }}</p>
  <p><strong>current_song.primary_playlist:</strong> {{ include.current_song.primary_playlist }}</p>

  {% assign current_song = include.current_song %}
  {% assign playlist_name = current_song.primary_playlist %}
  <p><strong>playlist_name:</strong> {{ playlist_name }}</p>

  {% assign related = site.data.music.songs | where: "primary_playlist", playlist_name %}
  <p><strong>related.size:</strong> {{ related.size }}</p>

  <p><strong>related URLs:</strong></p>
  <ul>
    {% for s in related %}
      <li>{{ s.url }}</li>
    {% endfor %}
  </ul>

  {% assign sorted_by_sequence = related | sort: "sequence" %}
  <p><strong>sorted_by_sequence.size:</strong> {{ sorted_by_sequence.size }}</p>

  {% assign first_item = sorted_by_sequence | first %}
  <p><strong>first_item.sequence:</strong> {{ first_item.sequence }}</p>

  {% if first_item.sequence %}
    {% assign playlist_sorted = sorted_by_sequence %}
  {% else %}
    {% assign playlist_sorted = related | sort: "title" %}
  {% endif %}

  <p><strong>playlist_sorted.size:</strong> {{ playlist_sorted.size }}</p>

  <p><strong>playlist_sorted URLs:</strong></p>
  <ul>
    {% for s in playlist_sorted %}
      <li>{{ s.url }}</li>
    {% endfor %}
  </ul>

</div>
<!-- DEBUG END -->
