---
layout: default
title: Music – Horizon Sound
---

{% assign all_songs = site.data.music.songs | where: "videostatus", "Public" %}
{% assign playlists = all_songs | map: "primary_playlist" | uniq | reject: "" | sort %}

<div class="music-page">

  <!-- VIEW TOGGLE -->
  <div class="view-toggle">
    <button class="view-toggle-button active" data-view="grouped">Grouped by Playlist</button>
    <button class="view-toggle-button" data-view="all">All Songs</button>
    <button class="view-toggle-button" data-view="carousel">Carousel View</button>
  
    <h2 class="page-title">Music Catalog</h2>
  </div>

  <!-- ------------------------------------------------
       VIEW 1: GROUPED BY PRIMARY PLAYLIST (DEFAULT)
  ------------------------------------------------- -->
  <section id="music-view-grouped">
  
    <!-- ============================
         PLAYLIST GRID (ALBUMS & ARCS)
    ============================= -->
    {% assign playlist_data = site.data.playlists | sort: "order" %}
    {% if playlist_data.size > 0 %}
    <section class="playlist-section">
      <h2 class="section-header">Playlists</h2>
  
      <div class="tile-grid">
        {% for p in playlist_data %}
          <a class="tile" href="/playlists/{{ p.playlist_id }}/">
            <img src="{{ p.image }}" alt="{{ p.title }}">
            <h3 class="tile-title">{{ p.title }}</h3>
          </a>
        {% endfor %}
      </div>
    </section>
    {% endif %}
  
    <!-- ==========================================
         GENRE / PRIMARY PLAYLIST GROUPS (Existing)
         Excluding playlists already in playlist_data
    =========================================== -->
    {% assign playlist_names = playlist_data | map: "title" %}
  
    {% for list in playlists %}
      {% unless playlist_names contains list %}
        {% assign songs_in_list = all_songs | where: "primary_playlist", list %}
        {% assign sorted_by_sequence = songs_in_list | sort: "sequence" %}
        {% assign first_item = sorted_by_sequence | first %}
  
        {% if first_item.sequence %}
          {% assign playlist_sorted = sorted_by_sequence %}
        {% else %}
          {% assign playlist_sorted = songs_in_list | sort: "title" %}
        {% endif %}
  
        {% if playlist_sorted.size > 0 %}
        <section class="playlist-section">
          <h2 class="section-header">{{ list }}</h2>
  
          <div class="tile-grid">
            {% for song in playlist_sorted %}
              <a class="tile" href="{{ song.url }}">
                <img src="{{ song.image }}" alt="{{ song.title }}">
                <h3 class="tile-title">{{ song.title }}</h3>
              </a>
            {% endfor %}
          </div>
        </section>
        {% endif %}
      {% endunless %}
    {% endfor %}
  
  </section>

  <!-- ------------------------------------------------
       VIEW 2: ALL SONGS (FLAT TILE GRID)
  ------------------------------------------------- -->
  <section id="music-view-all" style="display:none;">
    <section class="playlist-section">
      <h2 class="section-header">All Songs</h2>

      {% assign all_sorted = all_songs | sort: "title" %}
      <div class="tile-grid">
        {% for song in all_sorted %}
          <a class="tile" href="{{ song.url }}">
            <img src="{{ song.image }}" alt="{{ song.title }}">
            <h3 class="tile-title">{{ song.title }}</h3>
          </a>
        {% endfor %}
      </div>
    </section>
  </section>

  <!-- ------------------------------------------------
       VIEW 3: CAROUSEL ROWS BY PLAYLIST
  ------------------------------------------------- -->
  <section id="music-view-carousel" style="display:none;">
    {% for list in playlists %}
      {% assign songs_in_list = all_songs | where: "primary_playlist", list %}
      {% assign sorted_by_sequence = songs_in_list | sort: "sequence" %}
      {% assign first_item = sorted_by_sequence | first %}

      {% if first_item.sequence %}
        {% assign playlist_sorted = sorted_by_sequence %}
      {% else %}
        {% assign playlist_sorted = songs_in_list | sort: "title" %}
      {% endif %}

      {% if playlist_sorted.size > 0 %}
      <section class="playlist-section">
        <h2 class="section-header">{{ list }}</h2>

        <div class="playlist-carousel" data-carousel>
          <button class="carousel-arrow left-arrow" data-arrow="left">◀</button>

          <div class="horizontal-strip" data-strip>
            {% for song in playlist_sorted %}
              <a class="tile playlist-tile" href="{{ song.url }}">
                <img src="{{ song.image }}" alt="{{ song.title }}">
                <h3 class="tile-title">{{ song.title }}</h3>
              </a>
            {% endfor %}
          </div>

          <button class="carousel-arrow right-arrow" data-arrow="right">▶</button>
        </div>
      </section>
      {% endif %}
    {% endfor %}
  </section>

</div> <!-- end .music-page -->

<!-- --------------------------------------------------
     SCRIPT: VIEW TOGGLE + CAROUSEL ROWS
-------------------------------------------------- -->
<script>
document.addEventListener("DOMContentLoaded", function () {

  /* VIEW TOGGLE */
  const buttons = document.querySelectorAll(".view-toggle-button");
  const views = {
    grouped: document.getElementById("music-view-grouped"),
    all: document.getElementById("music-view-all"),
    carousel: document.getElementById("music-view-carousel"),
  };

  buttons.forEach((btn) => {
    btn.addEventListener("click", () => {
      const view = btn.getAttribute("data-view");

      buttons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");

      Object.keys(views).forEach(key => {
        views[key].style.display = (key === view) ? "" : "none";
      });
    });
  });

  /* CAROUSEL ROWS */
  const carousels = document.querySelectorAll("[data-carousel]");

  carousels.forEach((carousel) => {
    const strip = carousel.querySelector("[data-strip]");
    const leftArrow = carousel.querySelector('[data-arrow="left"]');
    const rightArrow = carousel.querySelector('[data-arrow="right"]');

    if (!strip || !leftArrow || !rightArrow) return;

    const TILE_WIDTH = 180;
    const TILE_GAP = 16;
    const SCROLL_AMOUNT = TILE_WIDTH + TILE_GAP;

    function updateArrows() {
      const maxScroll = strip.scrollWidth - strip.clientWidth;
      const current = strip.scrollLeft;

      if (current <= 0) leftArrow.classList.add("disabled");
      else leftArrow.classList.remove("disabled");

      if (current >= maxScroll - 1) rightArrow.classList.add("disabled");
      else rightArrow.classList.remove("disabled");
    }

    leftArrow.addEventListener("click", () => {
      strip.scrollBy({ left: -SCROLL_AMOUNT, behavior: "smooth" });
    });

    rightArrow.addEventListener("click", () => {
      strip.scrollBy({ left: SCROLL_AMOUNT, behavior: "smooth" });
    });

    strip.addEventListener("scroll", updateArrows);
    updateArrows();
  });
});
</script>
