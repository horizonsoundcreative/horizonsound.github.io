{% assign items = include.playlist | default: include.songs %}

{% if site.debug %}
<div class="debug-block">
  <pre style="background:#111; color:#0ff; padding:1rem; white-space:pre-wrap;">

CAROUSEL DEBUG
==============================

include.playlist: {{ include.playlist | jsonify }}
include.songs:    {{ include.songs | jsonify }}

MODE DETECTED:
{% if include.playlist %}
  PLAYLIST MODE (div tiles)
{% else %}
  SONG MODE (a tiles)
{% endif %}

ITEMS (titles + URLs):
{% for item in items %}
  - title: {{ item.title }}
    url:   {{ item.url }}
{% endfor %}

  </pre>
</div>
{% endif %}

<div class="carousel" data-carousel>

  <!-- LEFT ARROW -->
  <button class="carousel-arrow left-arrow" data-arrow="left">‹</button>

  <div class="horizontal-strip" data-strip>

    {% for item in items %}
      {% assign clean_url = item.url | replace: '//', '/' %}
      {% assign segments = clean_url | split: "/" %}
      {% assign last = segments | last %}
      {% if last == "" %}
        {% assign song_id = segments[segments.size - 2] %}
      {% else %}
        {% assign song_id = last %}
      {% endif %}
      {% assign song = item %}

      {% if include.playlist %}
        <!-- PLAYLIST MODE -->
        <div class="carousel-tile" data-song="{{ song.song_id }}">
          <img src="{{ item.image }}" alt="{{ song.title }}">
          <h3 class="tile-title">{{ song.title }}</h3>
        </div>
      {% else %}
        <!-- SONG PAGE MODE -->
        <a class="carousel-tile" data-song="{{ song_id }}" href="{{ item.url }}">
          <img src="{{ item.image }}" alt="{{ song.title }}">
          <h3 class="tile-title">{{ song.title }}</h3>
        </a>
      {% endif %}
    {% endfor %}
  </div>

  <!-- RIGHT ARROW -->
  <button class="carousel-arrow right-arrow" data-arrow="right">›</button>

</div>
